data Op
    | Op  m::{Meta} s::String

data Expr
    | UnOp         m::{Meta} o::Op e::Expr
    | BinOp        m::{Meta} o::Op e1::Expr e2::Expr
    | Const        m::{Meta} c::Const
    | Var          m::{Meta} x::Identifier
    | Abstr        m::{Meta} x::Pattern e::Expr
    | App          m::{Meta} e1::Expr e2::Expr
    | If           m::{Meta} e1::Expr e2::Expr e3::Expr
    | Record       m::{Meta} els::RecElems
    | Paren        m::{Meta} e::Expr
    | List         m::{Meta} es::Exprs
    | Elem         m::{Meta} e::Expr i::{Either String Integer}
    | Lookup       m::{Meta} e1::Expr e2::Expr 
    | Let          m::{Meta} bs::Bindings e::Expr
    | Table        m::{Meta} n::String cs::Columns ks::Keys
    | Relationship m::{Meta} a1::Cardinality e1::Expr a2::Cardinality e2::Expr k1::Key k2::Key
    | QComp        m::{Meta} q::QCompr
    
data QCompr
    | FerryCompr   m::{Meta} p::Pattern e1::Expr bd::ComprElems er::Expr
    | LINQCompr    m::{Meta} p::Pattern e1::Expr b::LINQBody
    | HaskellCompr m::{Meta}
    
data LINQBody 
    | LINQBody     m::{Meta} bd::ComprElems r::LINQResult c::MaybeContinuation
    
data Continuation 
    | Continuation m::{Meta} p::Pattern b::LINQBody

data ComprElem
    | CLet   m::{Meta} p::Pattern e::Expr
    | CWhere m::{Meta} e::Expr
    | CGroup m::{Meta} es::Exprs
    | COrder m::{Meta} es::ExprOrders
    | CFrom  m::{Meta} p::Pattern e::Expr

data LINQResult
    | Select m::{Meta} e::Expr
    | GroupBy m::{Meta} e1::Expr e2::Expr
    | GroupWith m::{Meta} e1::Expr e2::Expr

data ExprOrder
    | ExprOrder m::{Meta} e::Expr o::Order

data Pattern
    | PVar  m::{Meta} x::String
    | PPat  m::{Meta} xs::{[String]}

data Order
    | Ascending m::{Meta}
    | Descending m::{Meta}
    
data Cardinality
    | One m::{Meta}
    | Many m::{Meta}

data Key
    | Key m::{Meta} s::{[String]}

data Column
    | Column m::{Meta} n::String t::Type

data Binding
    | Binding m::{Meta} x::String e::Expr

data RecElem
    | TrueRec m::{Meta} i::String e::Expr
    | TuplRec m::{Meta} i::Int    e::Expr

type RecElems = [RecElem]
type Exprs = [Expr]
type Bindings = [Binding]
type Columns = [Column]
type Keys = [Key]
type ExprOrders = [ExprOrder]
type ComprElems = [ComprElem]
type MaybeContinuation = (Maybe Continuation)

deriving Continuation Op Expr ComprElem ExprOrder Pattern Order Cardinality Key Column Binding RecElem Type QCompr LINQBody LINQResult : Show, Eq

data Type
    | TInt m::{Meta}
    | TFloat m::{Meta}
    | TString m::{Meta}
    | TBool m::{Meta} 
