\section{Ferry Front language normalisation}

\begin{code}
 norm(c)              =  c
 norm((e1,..., en))   =  ( norm(e1) , ..., norm(e2) )
 norm({b1,..., bn})   =  {normb(b1) , ..., normb(bn)}
 norm([e1, ..., en])  =  [norm(e1) , ..., norm(en)]
 norm(table T (col1, ..., coln) with keys (k1, ..., k2)) 
                      =  table T (col1, ..., coln) with keys (k1, ..., k2)
 norm(e.p)            =  norm(e).p
 norm(e.n)            =  norm(e).n
 norm(e1(e2))         =  norm(lookup e2 e1)
 norm(e1 op e2)       =  norm(e1) op norm(e2)
 norm(op e1)          =  op norm(e1)
\end{code}

\begin{code}
    normb(v = e)  =  v = norm(e)
    normb(v)      =  v = v
    normb(e.v)    =  v = norm(e.v)
\end{code}